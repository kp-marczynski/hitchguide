(this.webpackJsonphitchguide=this.webpackJsonphitchguide||[]).push([[1],{152:function(e,t,n){e.exports=n(175)},159:function(e,t,n){var r={"./ion-action-sheet.entry.js":[177,5],"./ion-alert.entry.js":[178,6],"./ion-app_8.entry.js":[179,7],"./ion-avatar_3.entry.js":[180,17],"./ion-back-button.entry.js":[181,18],"./ion-backdrop.entry.js":[182,43],"./ion-button_2.entry.js":[183,19],"./ion-card_5.entry.js":[184,20],"./ion-checkbox.entry.js":[185,21],"./ion-chip.entry.js":[186,22],"./ion-col_3.entry.js":[187,44],"./ion-datetime_3.entry.js":[188,10],"./ion-fab_3.entry.js":[189,23],"./ion-img.entry.js":[190,45],"./ion-infinite-scroll_2.entry.js":[191,46],"./ion-input.entry.js":[192,24],"./ion-item-option_3.entry.js":[193,25],"./ion-item_8.entry.js":[194,26],"./ion-loading.entry.js":[195,27],"./ion-menu_3.entry.js":[196,28],"./ion-modal.entry.js":[197,8],"./ion-nav_2.entry.js":[198,14],"./ion-popover.entry.js":[199,9],"./ion-progress-bar.entry.js":[200,29],"./ion-radio_2.entry.js":[201,30],"./ion-range.entry.js":[202,31],"./ion-refresher_2.entry.js":[203,11],"./ion-reorder_2.entry.js":[204,16],"./ion-ripple-effect.entry.js":[205,47],"./ion-route_4.entry.js":[206,32],"./ion-searchbar.entry.js":[207,33],"./ion-segment_2.entry.js":[208,34],"./ion-select_3.entry.js":[209,35],"./ion-slide_2.entry.js":[210,48],"./ion-spinner.entry.js":[211,13],"./ion-split-pane.entry.js":[212,49],"./ion-tab-bar_2.entry.js":[213,36],"./ion-tab_2.entry.js":[214,15],"./ion-text.entry.js":[215,37],"./ion-textarea.entry.js":[216,38],"./ion-toast.entry.js":[217,39],"./ion-toggle.entry.js":[218,12],"./ion-virtual-scroll.entry.js":[219,50]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(r)},o.id=159,e.exports=o},161:function(e,t,n){var r={"./ion-icon.entry.js":[221,57]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(r)},o.id=161,e.exports=o},162:function(e,t,n){},163:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(98),i=n.n(a),l=n(38),c=n(82),s=(n(162),o.a.createContext(void 0)),u=n(226),m=n(128),d=n(94),y=n(95),f=n(96),p=n(97),v=n(129),g=n.n(v),h=n(76),b=n(63),j=n(120),w=n(70),S=n(228),E=function(e){var t=e.children;return o.a.createElement("div",null,t)},k=n(132),I=function(e){var t=e.source,n=e.style,o=void 0===n?void 0:n,a=e.zIndex,i=void 0===a?0:a,l=e.minZoom,c=void 0===l?0:l,u=e.maxZoom,m=void 0===u?14:u,d=Object(r.useContext)(s).map;return Object(r.useEffect)((function(){if(d){var e=new k.a({source:t,style:o,minZoom:c,maxZoom:m});return e.on("featureclick",(function(e){return console.log(e)})),d.addLayer(e),e.setZIndex(i),function(){d&&d.removeLayer(e)}}}),[d]),null},O=n(135),x=function(e){var t=e.source,n=e.zIndex,o=void 0===n?0:n,a=Object(r.useContext)(s).map;return Object(r.useEffect)((function(){if(a){var e=new O.a({source:t,zIndex:o});return a.addLayer(e),e.setZIndex(o),function(){a&&a.removeLayer(e)}}}),[a]),null},L=new h.a;L.setStyle(new b.c({image:new j.a({radius:20,fill:new w.a({color:"rgba(51,153,204,0.75)"})})}));var _=function(e){var t,n=e.children,a=e.view,i=e.moveEndCallback,v=Object(r.useRef)(),h=Object(r.useState)(null),b=Object(c.a)(h,2),j=b[0],w=b[1],k=Object(r.useState)(null),O=Object(c.a)(k,2),x=O[0],_=O[1];Object(r.useEffect)((function(){document.addEventListener("visibilitychange",(function(){null===j||void 0===j||j.updateSize()}))}),[j]),Object(r.useEffect)((function(){var e=new m.a;e.on("select",(function(t){var n,r;((null===(n=t.selected[0].getProperties())||void 0===n?void 0:n.name)||(null===(r=t.selected[0].getProperties())||void 0===r?void 0:r.description))&&(console.log(t.selected[0].getProperties()),L.setGeometry(t.selected[0].getProperties().geometry),_(t.selected[0].getProperties())),e.getFeatures().clear()}));var t={view:a,layers:[],controls:[],overlays:[],interactions:[new d.a,new y.a,new f.a,new p.a,e],tilePixelRatio:1},n=new u.a(t);return n.setTarget(v.current),w(n),n.on("moveend",i),function(){return n.setTarget(void 0)}}),[]);var P=Object(r.useRef)(),C=Object(r.useRef)();Object(r.useEffect)((function(){x?T():(P.current.style.transition=".5s ease-out",P.current.style.transform="translateY(".concat(25,"px) "))}),[x]),Object(r.useEffect)((function(){var e=P.current;Object(l.l)({el:e,gestureName:"my-swipe",direction:"y",onEnd:function(t){t.deltaY>20?"false"===e.dataset.open?(_(!1),L.setGeometry(void 0)):N():t.deltaY<-20&&T()}}).enable(!0),Object(l.l)({el:C.current,gestureName:"my-swipe2",direction:"y",onMove:function(e){e.event.preventDefault()}}).enable(!0)}),[]);var T=function(){var e=P.current;e&&(e.style.transition=".5s ease-in",e.style.transform="translateY(".concat(-350,"px) "),e.dataset.open="true")},N=function(){var e=P.current;e&&(e.style.transition=".5s ease-out",e.style.transform="translateY(".concat(-60,"px) "),e.dataset.open="false")};return o.a.createElement(s.Provider,{value:{map:j}},o.a.createElement("div",{ref:v,className:"ol-map"},n,o.a.createElement(E,null,o.a.createElement(I,{source:new S.a({features:[L]})}))),o.a.createElement(l.c,{ref:P,className:g()({bottomDrawer:!0,hiddenCard:!x})},o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(l.b,{size:"large",color:"dark",style:{height:10,width:100},onClick:function(){"true"===P.current.dataset.open?T():N()}})),o.a.createElement(l.e,null,o.a.createElement(l.f,null,null===x||void 0===x?void 0:x.name)),o.a.createElement(l.d,{ref:C},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:null!==(t=null===x||void 0===x?void 0:x.description)&&void 0!==t?t:"No description"},style:{overflowY:"scroll",height:275}}))))},P=n(5),C=n(225),T=n(69),N=n(72),D=n(131),z=n(113),A=(n(163),n(48)),G=n(93),M=n(227),Y=n(130);function Z(e){return'<?xml version="1.0" encoding="UTF-8"?>\n<kml xmlns="http://earth.google.com/kml/2.2">\n<Document>\n<name>World</name>\n<visibility>1</visibility>\n<Style id="placemark-blue">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/blu-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-green">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/grn-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-yellow">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/ylw-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-red">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/red-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-brown">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/wht-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-purple">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/purple-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-orange">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/orange-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n<Style id="placemark-pink">\n<IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/paddle/pink-circle.png</href></Icon><scale>0.75</scale></IconStyle>\n<LabelStyle><scale>0.5</scale></LabelStyle>\n</Style>\n\n'+e.map((function(e){var t,n;return'<Placemark xmlns="http://www.opengis.net/kml/2.2" id="'+e.i+'">\n<name>Spot '+e.i+"</name>\n<visibility>1</visibility>\n<address>"+e.c+(e.p?", "+e.p:"")+"</address>\n<description><![CDATA["+(e.t?"<b>Average waiting time: </b>"+e.t+"min<br/><br/>":"")+"<b>Description:</b><hr/>"+(null!==(t=e.d)&&void 0!==t?t:"")+"<br/>"+(null!==(n=e.o)&&void 0!==n?n:"")+"]]></description>\n<Point><coordinates>"+e.l+"</coordinates></Point>\n<styleUrl>#placemark-"+F(e.s)+"</styleUrl>\n</Placemark>"})).join("\n\n")+"</Document>\n</kml>\n"}var F=function(e){switch(e){case 5:return"green";case 4:return"blue";case 3:return"yellow";case 2:return"orange";case 1:return"red";default:return"purple"}},U=new h.a;U.setStyle(new b.c({image:new j.a({radius:6,fill:new w.a({color:"#3399CC"}),stroke:new N.a({color:"#fff",width:2})})}));var R=new z.a({projection:"EPSG:3857",center:Object(P.d)([17,51]),zoom:4,maxZoom:14}),W=new D.a({trackingOptions:{enableHighAccuracy:!0},projection:R.getProjection()}),B=new h.a;W.on("change:accuracyGeometry",(function(){B.setGeometry(W.getAccuracyGeometry())})),W.setTracking(!0),W.on("change:position",(function(){var e=W.getPosition();U.setGeometry(e?new T.a(e):void 0)})),document.addEventListener("visibilitychange",(function(){console.log("change1"),W.setTracking("hidden"!==document.visibilityState)}));var H=new h.a;H.setGeometry(new T.a(Object(P.d)([17,51]))),H.setStyle(new b.c({image:new j.a({radius:50,fill:new w.a({color:"#3399CC"}),stroke:new N.a({color:"#fff",width:2})}),text:new G.a({text:"42",scale:5})}));var J=function(){Object(r.useContext)(s);var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(),u=Object(c.a)(i,2),m=u[0],d=u[1],y=Object(r.useState)([]),f=Object(c.a)(y,2),p=f[0],v=f[1];Object(r.useEffect)((function(){setTimeout((function(){return a(!0)}),1e3),fetch("/hitchguide/assets/json/world.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){v(e);var t=Z(e.filter((function(e){return"PL"===e.c})));d(t)}))}),[]);document.addEventListener("visibilitychange",(function(){a(!1),setTimeout((function(){return a(!0)}),1e3)}));return o.a.createElement(l.k,null,o.a.createElement(l.g,{scrollY:!1},n&&o.a.createElement("div",{style:{width:"100%",height:"100%",position:"static"},id:"map-container"},o.a.createElement(_,{view:R,moveEndCallback:function(e){var t=R.getCenter();if(t){var n=Object(P.m)(t);d(Z(p.filter((function(e){var t=e.l.split(",").map((function(e){return parseFloat(e)}));return n[0]-4<t[0]&&n[0]+4>t[0]&&n[1]-2<t[1]&&n[1]+2>t[1]}))))}}},o.a.createElement(E,null,o.a.createElement(x,{source:new C.a({url:"https://ows.terrestris.de/osm/service?",params:{LAYERS:"OSM-WMS",TILED:!0,FORMAT:"image/png"},attributions:[],transition:0}),zIndex:0}),o.a.createElement(I,{source:new S.a({features:[B]})}),m&&o.a.createElement(I,{key:m,source:new S.a({features:new M.a({showPointNames:!1}).readFeatures(m,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}),minZoom:8}),o.a.createElement(I,{source:new S.a({features:[U]})}))),o.a.createElement("div",{className:"attribution",id:"attribution"},"\xa9 ",o.a.createElement("a",{href:"https://www.openstreetmap.org/copyright"},"OpenStreetMap")," contributors"),o.a.createElement("div",{className:"versionNumber"},"hitchguide"," v","0.0.54"),o.a.createElement(l.h,{vertical:"top",horizontal:"end",slot:"fixed"},o.a.createElement(l.i,{onClick:function(){var e=W.getPosition();e&&R.animate({center:e,zoom:12,rotation:0})}},o.a.createElement(l.j,{icon:A.i}))),m&&o.a.createElement(l.h,{vertical:"top",horizontal:"start",slot:"fixed"},o.a.createElement(l.i,{onClick:function(){return function(e,t){var n=new Blob([t],{type:"application/vnd.google-earth.kml+xml"});Object(Y.saveAs)(n,e+".kml")}("world",m)}},o.a.createElement(l.j,{icon:A.h}))))))},$=(n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),function(){return o.a.createElement(l.a,null,o.a.createElement(J,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[152,3,4]]]);
//# sourceMappingURL=main.7b5b7d09.chunk.js.map